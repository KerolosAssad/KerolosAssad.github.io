<!DOCTYPE html>
<html lang="en">

<head>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Virtual Museum Project Game</title>
</head>

<body>

<nav class="navbar" style="background-color: #900C3F">
  <div class="container-fluid">
      <a class="navbar-brand text-white">Current Page (Game)</a>
      <ul class="navbar-nav d-flex flex-row me-auto">
          <li class="nav-item">
              <a class="nav-link active me-4 text-white" aria-current="page" href="https://kerolosassad.github.io/VirtualMuseumFinalProjectPart1.html">Game</a>
          </li>
          <li class="nav-item me-4">
              <a class="nav-link text-white" href="https://kerolosassad.github.io/VirtualMuseumFinalProjectPart2.html">Search</a>
          </li>
      </ul>
  </div>
</nav>

<container>
  <div class="jumbotron jumbotron-fluid mt-7 p-5 text-white" style="background-color: #FF5733">
      <div class="row">
          <div class="col-lg-6">
              <p><img id="selectedArtwork" src="https://i.giphy.com/gdQsQ3tzDYWxXxc0gd.webp" alt="" class="img-fluid" style="width:100%"></p>
          </div>
          <div id="selectedInfo" class="col-lg-6">
              <h1 id="Title" class="display-6">Metropolitan Virtual Museum Game</h1>
              <h2 id="Subtitle" class="lead">Experience and be the judge of the open access collection of Metropolitan museum <i><b>Online</b></i></h2>
              <p id="smallText">*This website is not endorsed by the official Metropolitan museum and is just a test of the API provided by the museum</p>
              <p id="explanation">Explanation: This website is meant to be a game, where the website will generate 6 random artworks and you can select any of them. depending on rules, you will be awarded a certain score.</p>
              <h3 id="rules">Rules:</h3>
              <ul>
                  <li id="imageInfo1">Select 6 artworks and the game is over.</li>
                  <li id="imageInfo2">A normal artwork rewards 1 point and a highlighted artwork by the museum rewards 2 points.</li>
                  <li id="imageInfo3">You can reset the artwork selection you given 3 times using the <i id="yellowText">yellow</i> button at the bottom.</li>
                  <li id="imageInfo4">After playing you can use the <b id="wineRedText">wine red</b> navigation bar at the top to use the companion search website.</li>
              </ul>
              <h3 id="score"></h3>
              <img id="scoreImg" src="" alt="" class="img-fluid w-200 h-200">
          </div>
      </div>
  </div>
</container>
    

    <container>
      <div class="jumbotron jumbotron-fluid mt-7 p-5 text-white" style="background-color: #DAF7A6">
        <div class="row">
            <div class="col-4">
              <div class="thumbnail">
                <button type="button" disabled onclick="swapSelected(1)" id="button1">
                    <p><img id="imageSelOp1" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-200 h-200"></p>
                </button>
              </div>
            </div>
            <div class="col-4">
              <div class="thumbnail">
                <button type="button" disabled onclick="swapSelected(2)" id="button2">
                    <p><img id="imageSelOp2" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-100 h-100"></p>
                </button>
              </div>
              </div>
            <div class="col-4">
              <div class="thumbnail">
                <button type="button" disabled onclick="swapSelected(3)" id="button3">
                    <p><img id="imageSelOp3" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-100 h-100"></p>
                </button>
              </div>
            </div>
        </div>
        </div>
    </container>

    <container>
      <div class="jumbotron jumbotron-fluid mt-7 p-5 text-white" style="background-color: #DAF7A6">
      <div class="row">
          <div class="col-4">
            <div class="thumbnail">
              <button type="button" disabled onclick="swapSelected(4)" id="button4">
                  <p><img id="imageSelOp4" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-100 h-100"></p>
              </button>
            </div>
          </div>
          <div class="col-4">
            <div class="thumbnail">
              <button type="button" disabled onclick="swapSelected(5)" id="button5">
                  <p><img id="imageSelOp5" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-100 h-100"></p>
              </button>
            </div>
          </div>
          <div class="col-4">
            <div class="thumbnail">
              <button type="button" disabled onclick="swapSelected(6)" id="button6">
                  <p><img id="imageSelOp6" src="https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif" alt="" class="img-fluid w-100 h-100"></p>
              </button>
            </div>
          </div>
      </div>
      </div>
  </container>

  <container>
    <div class="row">
      <div class="col-12">
        <button id="reRollButton" type="button" class="btn btn-warning btn-lg btn-block" onclick="reroll()" style="width: 100%"></button>
      </div>
    </div>
  </container>
  
  <container>
    <div class="row">
     <div class="col-12">
      <p id="endMessage">click to randomize the artworks</p>  
     </div>
    </div>
  </container>
    

    <hr>This website was created on Thursday, April 18th, 2024, by Kerolos Assad.

    <script>
        let numOfSelects=6
        let numOfRerolls=3;
        let score=0;

        document.getElementById("reRollButton").innerText = "Get More Artworks (number of re-rolls left "+numOfRerolls+")";
        document.getElementById("smallText").style.fontSize = "xx-small";
        document.getElementById("yellowText").style.color="yellow";
        document.getElementById("wineRedText").style.color="#900C3F";

        async function getRequestFunction(endpoint) {
            const url = endpoint;
            const options = {
                method: 'GET',
            };
            const response = await fetch(url, options);
            const result = await response.json();
            return result;
        }

        let obj1 = null; //obj1 as a global object storing the data of ids, so it won't be loaded over and over again

        async function init() {
            document.getElementById("reRollButton").disabled = true;
            obj1 = await getRequestFunction('https://collectionapi.metmuseum.org/public/collection/v1/search?hasImages=true&q=*'); //'*' wild card character for most number of results
            const imageIds = ['imageSelOp1', 'imageSelOp2', 'imageSelOp3', 'imageSelOp4', 'imageSelOp5', 'imageSelOp6'];
            const buttons = ['button1', 'button2', 'button3', 'button4', 'button5', 'button6'];
            const objects = await Promise.all(imageIds.map(getObjFliteredNorm));
            for (let i = 0; i < imageIds.length; i++) {
                document.getElementById(imageIds[i]).src = objects[i].primaryImageSmall;
                document.getElementById(imageIds[i]).alt = objects[i].objectID;
                document.getElementById(buttons[i]).disabled = false;
            }
            if (numOfRerolls != 0)
               document.getElementById("reRollButton").disabled = false;
        }

        init();

        async function getRandObj() {
            let idArr = obj1.objectIDs;
            let randomIndex = Math.floor(Math.random() * obj1.total);
            let artId = idArr[randomIndex];
            let obj2 = await getRequestFunction(`https://collectionapi.metmuseum.org/public/collection/v1/objects/${artId}`);
            return obj2;
        }

        async function getObjFliteredNorm() {
            let newObj = await getRandObj();
            let newObjId=newObj.objectID+1;
            let includeHighlighted = Math.random() < 0.2;
            while (newObj.primaryImageSmall === '' || newObj.message === "Not a valid object" || newObj.message === "ObjectID not found" || (includeHighlighted && newObj.isHighlight === false)) {
                newObj = await getRandObj();
            }
            return newObj;
        }


        async function swapSelected(k) {
            numOfSelects=numOfSelects-1
            let chosenObjId=document.getElementById('imageSelOp'+k).alt;
            let chosenObj= await getRequestFunction(`https://collectionapi.metmuseum.org/public/collection/v1/objects/${chosenObjId}`);
            document.getElementById("selectedArtwork").src = chosenObj.primaryImage;
            document.getElementById("explanation").innerText = "";
            document.getElementById("rules").innerText = "Artwork #" + (6 - numOfSelects);
            document.getElementById("imageInfo1").innerText = "ID: " + chosenObj.objectID;
            document.getElementById("imageInfo2").innerText = "Titled: " + chosenObj.title;
            document.getElementById("imageInfo3").innerText = "Highlighted: " + chosenObj.isHighlight;
            document.getElementById("imageInfo4").innerText = "Department: " + chosenObj.department;
            document.getElementById('button'+k).disabled = true;
            if (chosenObj.isHighlight===true)
                score=score+2;
            else
                score=score+1; 
            document.getElementById("score").innerText="Score: "+score;

            if (numOfSelects === 0)
              conclusion();
        }

        function reroll(){
        for (let i = 1; i < 7; i++){
          document.getElementById('imageSelOp' + i).src = 'https://mir-s3-cdn-cf.behance.net/project_modules/disp/04de2e31234507.564a1d23645bf.gif';
          document.getElementById('button' + i).disabled = true; 
        }
       init();
       numOfRerolls--;
       document.getElementById("reRollButton").innerText = "Get More Artworks (number of re-rolls left " + numOfRerolls + ")"; 
        }


        function conclusion(){
          numOfRerolls=0;
          document.getElementById("reRollButton").innerText = "Get More Artworks (number of re-rolls left 0)";
          document.getElementById("reRollButton").disabled = true;
             for (i=1; i<7; i++){
              document.getElementById('imageSelOp' + i).src = 'https://i.gifer.com/origin/32/320d18ec547b5284b9dae434333bd277_w200.gif';
              document.getElementById('button'+i).disabled = true;
             }
            switch (score) {
            case 6: 
            document.getElementById("scoreImg").src = "https://www.artiestick.com/toons/alphabet/numbers/arg-6-50-trans.gif";
            break;
            case 7: 
            document.getElementById("scoreImg").src = "https://www.artiestick.com/toons/alphabet/numbers/arg-7-50-trans.gif";
            break;
            case 8: 
            document.getElementById("scoreImg").src = "https://www.artiestick.com/toons/alphabet/numbers/arg-8-50-trans.gif";
            break;
            case 9: 
            document.getElementById("scoreImg").src = "https://www.artiestick.com/toons/alphabet/numbers/arg-9-50-trans.gif";
            break;
            case 10: 
            document.getElementById("scoreImg").src = "https://i.giphy.com/jrADhdghPV1ceZMLeP.webp";
            break;
            case 11: 
            document.getElementById("scoreImg").src = "https://i.giphy.com/2All1ZIgd2L7Egww22.webp";
            break;
            case 12: 
            document.getElementById("scoreImg").src = "https://i.giphy.com/0yp1UzqC8z5bskNExG.webp";
            break;
            case defualt:
            break;
        }
      }
    </script>

</body>

</html>
